<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Interactive Orthographic Globe (Observable Plot + D3)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    body { margin: 0; display: grid; place-items: center; height: 100vh; background:#f6f7f9; }
    #container { width: 600px; height: 600px; }
    svg { background: white; border-radius: 10px; box-shadow: 0 6px 18px rgba(0,0,0,0.12); }
    .hint { position: fixed; bottom: 16px; font: 13px/1.2 system-ui, sans-serif; color:#555; }
  </style>
  <script src="https://cdn.jsdelivr.net/npm/d3@7"></script>
</head>
<body>
  <div id="container"></div>
  <div class="hint">ðŸ’¡ Drag to rotate. Double-click to reset.</div>

  <script type="module">
    import * as Plot from 'https://cdn.jsdelivr.net/npm/@observablehq/plot@0.6/+esm';
    import { feature } from 'https://cdn.jsdelivr.net/npm/topojson-client@3/+esm';

    const coords =

[[[[-99.52316615028741, -3.7450437470058215], [-102.31681156298443, -7.3098511437293086], [-106.47391434652876, -6.608494376194796], [-107.80031250106053, -2.5640667726764135], [-109.71988821036106, -2.2812832631930045], [-111.84870286236902, -2.1675662435525274], [-114.02904784459382, -5.242929409571677], [-118.12335777862991, -4.986310192743098], [-120.24551240318443, -1.6912650463504653], [-124.29849277976768, -1.4476428602001996], [-125.88346072177119, -5.21502760786271], [-129.7100658202636, -6.134248764846947], [-132.10150849305654, -3.156710274879981], [-136.27080761114607, -4.045894876233991], [-138.95903110794228, -0.8353130739527114], [-143.3961790952625, -1.706579969821454], [-144.9683236097968, -5.820413131280587], [-149.4028814909321, -6.672537737437516], [-152.3980821982831, -3.4345808068957697], [-156.8531091350144, -4.259065522271725], [-159.93112334382027, -0.9446533902388665], [-164.25615857265893, -1.7743965588128086], [-165.41674992858833, -5.762860491436919], [-169.716819501222, -6.40267724803141], [-170.89762858145173, -4.860811812073258], [-172.34353547812253, -3.2930086626395747], [-176.05696384421353, -3.968796976609587], [-178.7982364398432, -0.9361637645983817], [177.85728757138187, -1.6469189364220578], [177.64333529652887, -2.8342226226867955], [176.33760338440166, -5.048182136577354], [175.13738387330054, -5.210610931400808], [172.6216473977064, -4.648343501025622], [170.30471851499902, -7.173126163814265], [166.291853296082, -6.270965136275794], [165.84925104057967, -2.2362517307541014], [162.3206084434784, -0.7857626165462426], [159.11445596529225, -3.586179719894016], [155.2010590098167, -2.0884757961035625], [151.73819615689132, -5.002988319007183], [147.5198718874505, -3.4549175353760195], [143.89793445781356, -6.411812861671425], [139.50821118876502, -4.8099164186777035], [135.85958708181397, -7.725284543519058], [131.46580432259714, -6.071099094574541], [127.93166510631232, -8.86688505875448], [123.69917439607623, -7.171745433550871], [122.89284782634661, -2.7228891610396557], [118.80144676595566, -1.0908183695418654], [115.67172827000326, -3.8245323459249185], [111.64832534337992, -2.7687426994117614], [108.41587913607124, -5.894708224614658], [104.12723993254785, -4.8213435637194655], [100.8349613071672, -7.941423794133487], [96.41687824651858, -6.827381161385126], [95.22669343176798, -2.5046046873156858], [90.71723526584819, -1.3006030285245258], [87.52859397085601, -4.455546808882523], [83.16385904323403, -3.2418753100088593], [81.18491296412186, -5.250784448542952], [80.14091487099121, -6.2027935014485225], [75.82322591156387, -4.902363341799053], [72.46372397098733, -7.772426211612159], [68.12880718791868, -6.382401917945719], [67.36290022706116, -2.2670217695307624], [63.3061222521409, -0.9781516831001118], [59.88485456478613, -3.625405109717659], [56.04076373667954, -2.3041178869669148], [54.342630992672014, -3.5933241882305116], [52.68952639184418, -4.612860727482492], [49.07628278330157, -2.3547343129537177], [45.43387749209455, -4.428418751970285], [41.58665495463515, -2.0439831300982623], [37.62415943093452, -4.150912683092272], [33.66361927713152, -1.6772949381945044], [29.508441243966416, -3.781047572700436], [25.58678516686, -1.2704435740827693], [21.40032508185986, -3.335734857517352], [17.669408104914115, -0.8469844525190816], [13.611699107391518, -2.8447525350379235], [10.189893676135952, -0.43188476755339716], [6.386373526666488, -2.3418038147608624], [3.3406661153006625, -0.04510060679510636], [-0.1336889125916577, -1.8554926185476641], [-0.7828391751055227, -5.889921754313915], [-4.805183856824203, -6.586859421326589], [-7.615506108749893, -3.845828260484011], [-11.66474754212644, -4.4670316097845], [-13.559193205964707, -0.8762512952424143], [-17.373147196370113, -0.8227221314451982], [-19.325125801816437, -4.604844470308616], [-23.52422244327238, -4.645743871293199], [-25.721264011811797, -0.6931851479671439], [-30.203425049597982, -0.6173843220866737], [-32.528267829318835, -4.649620438680767], [-37.243135362944614, -4.606028555705817], [-39.563133079118444, -0.44748322046602834], [-44.322948507187284, -0.3562094817730327], [-46.800487381563165, -4.422917404204754], [-51.51182762864842, -4.287152921751077], [-53.68204442813005, -0.17017772412858903], [-58.163640147998116, -0.07918007660184663], [-60.50309415506542, -3.9486914533379958], [-63.32276713921543, -3.8221019268338665], [-64.72810407520194, -3.684741680505737], [-67.11855039005962, -7.389406912237246], [-71.61986799886888, -7.003123550980988], [-73.58831704620168, -2.7703025791670175], [-78.21816398026434, -2.2641433736476846], [-80.99438115089971, -6.061929363987141], [-85.74830788668204, -5.520060963403992], [-87.59400415255666, -1.1964275116101613], [-92.21612396381302, -0.6561288240742991], [-95.07033345637271, -4.3484866954754455], [-99.52316615028741, -3.7450437470058215]], [[-53.40381944858905, 7.7522909940025615], [-51.252815863927914, 3.813394894857517], [-46.5899429561277, 3.76138350054279], [-44.14041291818604, 7.725284543519059], [-39.43410523143184, 7.635035982578252], [-37.14019742640149, 3.5803293669296306], [-32.48012811254947, 3.4549175353760115], [-30.182215330720936, 7.309910883327083], [-25.750258419602837, 7.086582997425367], [-23.577254165479836, 3.152670815193172], [-19.42154916686706, 2.985051052916481], [-17.487884167109748, 6.558659438572163], [-13.708146703918002, 6.270965136275773], [-11.830186971127075, 2.638932741201293], [-8.412776379912247, 2.467580053183621], [-7.899841472392981, 3.559837831413195], [-6.064496108778538, 5.362739776582626], [-4.862616126699467, 5.2106109314008116], [-2.5790347646674987, 4.020023638586551], [0.3098039635355267, 5.864518365517619], [3.9430361557864506, 3.968796976609581], [7.212914562720072, 5.860392168376587], [9.102371418548282, 4.860811812073258], [10.722777827285633, 3.789624991750129], [14.583250071411674, 5.762860491436915], [18.09981644071494, 3.5346227999232194], [22.136132249356994, 5.527020080114615], [25.886010570251138, 3.202074339142956], [29.961298273611618, 5.1819226249528905], [33.814945033944454, 2.8026599483934844], [37.77676428812329, 4.74095538189142], [41.59000566215463, 2.3586899160008272], [45.30258805566046, 4.232719683025157], [48.94706885744921, 1.898270439192623], [52.316592444657616, 3.6927532541940127], [55.70150722023228, 1.4476428602002083], [58.9668320668832, 3.9090460692491074], [62.72776317867667, 2.7916780404471604], [65.97095215540618, 5.242929409571677], [69.63381057288798, 4.311473809758376], [72.19363429195394, 7.473863638092713], [76.26408541439847, 6.511600732441479], [77.5983036432562, 2.2233436292223394], [81.85307387147245, 1.084853908628409], [84.9296665436273, 4.348486695475442], [89.44185686196764, 3.1743094571295885], [92.75068396053875, 6.523960823111651], [97.37304065193962, 5.289412273297663], [100.80136063472526, 8.618890658103629], [105.35716758404885, 7.303218576160169], [106.41168295379833, 2.7703025791670135], [110.72399425598124, 1.5358657755021414], [113.98513214459506, 4.6721309865719345], [116.67723286078457, 3.8221019268338448], [117.99888533923311, 3.3267128731190114], [121.26764633911117, 6.289184675341438], [125.50231533878872, 4.763431183575369], [129.04492009156368, 7.805398745803346], [133.49441060685513, 6.197676527808861], [137.1970727246292, 9.231452670299692], [141.69432910913807, 7.537486471095007], [142.43997538991445, 2.835154500117894], [146.82860631815936, 1.146470566433399], [150.44123001544202, 4.084015752678349], [154.59893532317398, 2.3920322085174726], [158.00676432627483, 5.1890555165121155], [161.81561480968847, 3.5081042246681515], [164.93539603741021, 6.119591258608642], [168.33525245787357, 4.467031609784497], [172.03418236939353, 6.172978893164637], [175.46041201203371, 4.248592317017825], [179.2171608248945, 5.88992175431389], [-178.02519665249852, 2.9040374505798114], [-174.31673738369324, 3.8210244943304374], [-171.37544324872502, 0.649870565576401], [-167.31261713417402, 1.5147974903819574], [-166.16940101623453, 5.767146686378417], [-161.77338167921764, 6.766536253596436], [-158.59967491814012, 3.335734857517349], [-154.0294052002189, 4.260374459536214], [-150.91862197114955, 0.7969950664894166], [-146.33638072286848, 1.6772949381945044], [-144.72979242136543, 6.045591181415267], [-140.12125038010964, 6.870649308036964], [-137.3063271216714, 3.372828505596593], [-132.96499017492758, 4.158942627265325], [-130.4608587551884, 0.8436031110165414], [-126.47619542382564, 1.6263637306496364], [-125.65736900732797, 3.5933241882305222], [-124.74319077977674, 5.304322366655776], [-120.47268446128629, 5.165048115302317], [-118.22978761288444, 1.54661270011944], [-113.91041930526723, 1.3300762483231614], [-111.60261207801032, 4.785398917150398], [-107.10416387391813, 4.548448008485299], [-105.17323884809628, 0.8701881901666886], [-101.04824320818962, 0.3854149473714064], [-98.30082499679779, 3.9382989654374976], [-93.91140202136133, 3.4938029769751124], [-91.12007106136942, 7.059508613810285], [-86.58999355148684, 6.605186625257111], [-84.77330656823203, 2.5046046873156858], [-80.13485884440162, 1.9759215335086475], [-77.44069883550374, 5.5631423675199665], [-72.93661775503374, 4.9951927162657395], [-71.0160747003525, 0.901274271496053], [-66.64455573288102, 0.3760386871585963], [-64.32827172999673, 3.8245323459248906], [-60.165868273993155, 3.8426199422059493], [-57.84643084054915, 7.694210873901278], [-53.40381944858905, 7.7522909940025615]]]]

;


    const poly = {
      type: 'Feature',
      properties: { name: 'Rough CONUS outline' },
      geometry: {type: 'MultiPolygon', coordinates: coords}
    };

    // ---- State for interactivity ----
    const state = {
      rotate: [100, -40, 0],   // roughly centers the U.S.
      width: 600,
      height: 600
    };

    // Load coastlines (land) once and convert TopoJSON -> GeoJSON
    const landTopo = await (await fetch('https://cdn.jsdelivr.net/npm/world-atlas@2/land-110m.json')).json();
    const land = feature(landTopo, landTopo.objects.land);

    function preview(geometryOrFeature, rotate) {
      return Plot.plot({
        width: state.width,
        height: state.height,
        projection: { type: 'orthographic', rotate, inset: 1 },
        marks: [
          Plot.geo(land, {
            stroke: '#88b',
            fill: 'none',
            strokeWidth: 0.8,
            strokeOpacity: 0.8
          }),
          Plot.geo(geometryOrFeature, {
            fill: 'red',
            fillOpacity: 0.45,
            stroke: 'red',
            strokeOpacity: 0.7
          }),
          Plot.graticule({ strokeOpacity: 0.06 }),
          Plot.sphere({ strokeWidth: 2 })
        ]
      });
    }

    const container = document.getElementById('container');

    let frame = null;
    function render() {
      if (frame) return;
      frame = requestAnimationFrame(() => {
        frame = null;
        container.innerHTML = '';
        const svg = preview(poly, state.rotate);
        container.appendChild(svg);
        attachDrag(svg);
      });
    }

    function attachDrag(svg) {
      const drag = d3.drag()
        .on('start', (event) => {
          drag.startX = event.x;
          drag.startY = event.y;
          drag.startRotate = state.rotate.slice();
        })
        .on('drag', (event) => {
          const dx = event.x - drag.startX;
          const dy = event.y - drag.startY;
          const k = 0.25;
          state.rotate = [
            drag.startRotate[0] + dx * k,
            drag.startRotate[1] - dy * k,
            0
          ];
          render();
        });

      d3.select(svg).call(drag);
      d3.select(svg).on('dblclick', () => {
        state.rotate = [100, -40, 0];
        render();
      });
    }

    render();
  </script>
</body>
</html>
